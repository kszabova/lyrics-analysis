<!DOCTYPE html>

<html>
    <head>
        <title>Song comparison</title>
        {% load static %}
        <link rel="stylesheet" type="text/css" href="{% static 'comparison/evaluate_lyrics.css' %}">
    </head>

    <body>
        <script type="text/javascript">
            var names = [];
            var titles = [];
            var lyrics = [];
            var rhymeScores = [];
            var tfidfScores = [];
            var rhymeAvgs = [];
            var tfidfAvgs = [];
            {% for artist in artists %}
                names.push("{{ artist.0|escapejs }}");
                titles.push("{{ artist.2.song.title|escapejs }}");
                lyrics.push("{{ artist.2.song.lyrics|linebreaks|escapejs }}")
                rhymeScores.push("{{ artist.2.rhyme_score|floatformat:'2' }}");
                tfidfScores.push("{{ artist.2.tfidf_score|floatformat:'2' }}");
                rhymeAvgs.push("{{ artist.0.rhyme_score_avg|floatformat:'2' }}");
                tfidfAvgs.push("{{ artist.0.tfidf_score_avg|floatformat:'2' }}");
            {% endfor %}

            {% if better %}
            betterArtist = "{{ better.song.artist|escapejs }}";
            betterTitle = "{{ better.song.title|escapejs }}";
            betterRhymeScore = "rhymes: {{ better.rhyme_score|floatformat:'2' }}";
            betterTfidfScore = "tf-idf: {{ better.tfidf_score|floatformat:'2' }}";
            betterRhymeAvg = "rhymes: {{ better.song.artist.rhyme_score_avg|floatformat:'2' }}";
            betterTfidfAvg = "tf-idf: {{ better.song.artist.tfidf_score_avg|floatformat:'2' }}";
            {% endif %}

            {% if worse %}
            worseArtist = "{{ worse.song.artist }}";
            worseTitle = "{{ worse.song.title }}";
            worseRhymeScore = "rhymes: {{ worse.rhyme_score|floatformat:'2' }}";
            worseTfidfScore = "tf-idf: {{ worse.tfidf_score|floatformat:'2' }}";
            worseRhymeAvg = "average rhymes: {{ worseArtist.rhyme_score_avg|floatformat:'2' }}";
            worseTfidfAvg = "average tf-idf: {{ worseArtist.tfidf_score_avg|floatformat:'2' }}";
            {% endif %}

            function showWorseSong() {
                document.getElementById("artist").innerHTML = worseArtist;
                document.getElementById("title").innerHTML = worseTitle;
                document.getElementById("lyrics").innerHTML = "{{ worse.song.lyrics|linebreaks|escapejs }}";
                document.getElementById("rhymeScore").innerHTML = worseRhymeScore;
                document.getElementById("tfidfScore").innerHTML = worseTfidfScore;
                document.getElementById("avgRhymeScore").innerHTML = worseRhymeAvg;
                document.getElementById("avgTfidfScore").innerHTML = worseTfidfAvg;
                document.getElementById("comparisonLyrics").style.display = "inline-block";
                document.getElementById("comparisonScore").style.display = "inline-block";
            }

            function showBetterSong() {
                document.getElementById("artist").innerHTML = betterArtist;
                document.getElementById("title").innerHTML = betterTitle;
                document.getElementById("lyrics").innerHTML = "{{ better.song.lyrics|linebreaks|escapejs }}";
                document.getElementById("rhymeScore").innerHTML = betterRhymeScore;
                document.getElementById("tfidfScore").innerHTML = betterTfidfScore;
                document.getElementById("avgRhymeScore").innerHTML = betterRhymeAvg;
                document.getElementById("avgTfidfScore").innerHTML = betterTfidfAvg;
                document.getElementById("comparisonLyrics").style.display = "inline-block";
                document.getElementById("comparisonScore").style.display = "inline-block";
            }

            function showSong(i) {
                i = i-1;
                document.getElementById("artist").innerHTML = names[i];
                document.getElementById("title").innerHTML = titles[i];
                document.getElementById("lyrics").innerHTML = lyrics[i];
                document.getElementById("rhymeScore").innerHTML = rhymeScores[i];
                document.getElementById("tfidfScore").innerHTML = tfidfScores[i];
                document.getElementById("avgRhymeScore").innerHTML = rhymeAvgs[i];
                document.getElementById("avgTfidfScore").innerHTML = tfidfAvgs[i];
                document.getElementById("comparisonLyrics").style.display = "inline-block";
                document.getElementById("comparisonScore").style.display = "inline-block";
            }
        </script>

        <div id="header"></div>
        <div id="songView">
            <table style="width: 80vw; margin: auto">
                <tr>
                    <td class="songColumn">
                        <div id="songLyrics" class="song">
                                <div class="innerContent">
                                <h3 class="title">{{ score.song.title}}</h3>
                                <h4 class="artist">{{ score.song.artist }}</h4>
                                <div class="lyrics">{{ score.song.lyrics|linebreaks }}</div>
                            </div>
                        </div>
                    </td>

                    <td class="scoreColumn">
                        <div id="songScore" class="score">
                            <div class="innerContent">
                                <ul>
                                    <li>rhymes: {{ score.rhyme_score|floatformat:'2' }}</li>
                                    <li>tf-idf: {{ score.tfidf_score|floatformat:'2' }}</li>
                                </ul>
                            </div>
                        </div>
                    </td>

                    <td class="buttonColumn">
                        {% for artist in artists %}
                        <div class="btnWrapper">
                            <button class="btnPlaceholder"type="button"></button>
                            <button class="btn" type="button" onclick="showSong({{ forloop.counter }})">{{ forloop.counter }}</button>
                        </div>
                        {% endfor %}
                    </td>

                    <td class="scoreColumn">
                        <div id="comparisonScore" class="score" style="display:none">
                            <div class="innerContent">
                                <div class="stats">Artist stats:</div>
                                <ul>
                                    <li id="avgRhymeScore"></li>
                                    <li id="avgTfidfScore"></li>
                                </ul>
                            </div>
                            <div class="innerContent">
                                <div class="stats">Song stats:</div>
                                <ul>
                                    <li id="rhymeScore"></li>
                                    <li id="tfidfScore"></li>
                                </ul>
                            </div>
                        </div>
                    </td>

                    <td class="songColumn">
                        <div id="comparisonLyrics" class="song" style="display:none">
                            <div class="innerContent">
                                <h3 class="title" id="title"></h3>
                                <h4 class="artist" id="artist"></h4>
                                <div class="lyrics" id="lyrics"></div>
                            </div>
                        </div>
                    </td>

                </tr>
            </table>
        </div>
    </body>
</html>